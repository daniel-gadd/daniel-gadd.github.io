<!doctype html>
    <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
    <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
    <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
    <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->

    
      
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Daniel Gadd</title>
        <meta name="author" content="Daniel Gadd">
        
        <meta name="description" content="Better management of ssh config files May 5th, 2015 ssh linux configuration Prerequisite: For this setup im using zsh with aliases, but bash will &hellip;">
        
        <meta name="viewport" content="width=device-width">
        <link rel="canonical" href="http://www.gadd.co.nz/blog">

        <link href='http://fonts.googleapis.com/css?family=Droid+Serif:400,400italic' rel='stylesheet' type='text/css'>
        <link href="http://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">

        
        <link href="/favicon.png" rel="icon">
        <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
        <link href="/atom.xml" rel="alternate" title="Daniel Gadd" type="application/atom+xml">
    </head>


    <body >

        <header id="header">
    <div class="row">
    <div class="col-xs-12 col-sm-8 col-md-4">
        <a href="/" class="site-title">Daniel Gadd</a>
    </div>
    <div class="col-xs-12 col-sm-4 col-md-8">
        <nav>
    <input type="checkbox" id="toggle">
    <label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
    <ul class="menu">
    <li><a href="/">Home</a></li>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/about/">About Me</a></li>
</ul>

</nav>

    </div>
</div>

</header>


        <div id="main-content">

            <!--[if lte IE 9]>
<div class="row upgrade-row">
    <div class="col-lg-12">
        <div class="upgrade">
            <i class="upgrade__icon fa fa-warning"></i>
            <h1 class="upgrade__title h6">Ohnoes!</h1>
            <p class="upgrade__text">
                Unfortunately, certain parts of this site may not display correctly in your version of Internet Explorer!<br>
                If possible, you should consider <a href="http://browsehappy.com/">upgrading your browser</a>.
            </p>
        </div>
    </div>
</div>
<!-- <![endif]-->


            

            <div class="row top-xs center-sm center-md center-lg site-wrapper">
                
                <div class="col-xs-12 col-sm-10 col-md-8 col-lg-8">
                
                        
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2015/05/05/better-management-of-ssh-config-files/">Better management of ssh config files</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2015-05-05T19:54:19+12:00" pubdate><i class="fa fa-calendar"></i> May 5th, 2015</time>




            

    <div class="article__tags pull-left">
        <i class="fa fa-tags"></i>
        <ul class="unstyled">
        
            
                <li><a class='category' href='/blog/categories/ssh/'>ssh</a></li>
            
                <li><a class='category' href='/blog/categories/linux/'>linux</a></li>
            
                <li><a class='category' href='/blog/categories/configuration/'>configuration</a></li>
            
            
        </ul>
    </div>


            
        </div>
    
</header>




    <h3>Prerequisite:</h3>

<p>For this setup im using zsh with aliases, but bash will also work.</p>

<h3>My ssh config setup</h3>

<p>My ~./.ssh/config file was getting rather large and becoming a management nightmare. I have personal servers, work specific servers, domain wildcards
global wildcards etc etc. I&rsquo;d estimate I had close to 30 hosts in a single file.</p>

<p>I decided It would be better to split my master config out into smaller logical chunks and concatinate them all together everytime I call the &lsquo;ssh&rsquo; command.
This means I can easily find and logically order my Hosts in A way which works for me.</p>

<h4>How does it work</h4>

<p>I split my configuration file into 4 logical chunks (there are more, but they&rsquo;re business sensitive - but 4 will give you an idea):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat ~/.ssh/conf.d/
</span><span class='line'>   000-header
</span><span class='line'>   100-personal
</span><span class='line'>   200-work-related
</span><span class='line'>   400-global</span></code></pre></td></tr></table></div></figure>


<p>As you can see, ive used numbering to create an order in assending order. Applying the header first and finally the global config which holds the <code>Host *</code> config which get applied to everything, unless its been specified further up.</p>

<p>My ssh alias command calls &lsquo;cat&rsquo;, removes some vim comments to enable syntax highlighting and finally throws the generated file into ~/.ssh/config. Finally I call the &lsquo;ssh&rsquo; command.</p>

<p>Heres what my zsh command alias looks like:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">alias </span><span class="nv">ssh</span><span class="o">=</span><span class="s2">&quot;cat ~/.ssh/conf.d/\* |</span>
</span><span class='line'><span class="s2">  sed &#39;/vim: set/d&#39; &gt; ~/.ssh/config &amp;&amp;</span>
</span><span class='line'><span class="s2">  chmod 0600 ~/.ssh/config &amp;&amp; ssh&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Note: I added newlines to the code snippet so it was readable.</em></p>

<h3>What my Host blocks look like</h3>

<h5>Heres my header file:</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>\##################################################################
</span><span class='line'>\# SSH CONFIG FILE
</span><span class='line'>
</span><span class='line'>\# THIS FILE IS AUTOMATICALLY GENERATED - YOUR CHANGES WILL BE LOST.
</span><span class='line'>\# IF YOU NEED TO CHANGE IT, CHANGE CONFIGS IN ~/.ssh/conf.d/
</span><span class='line'>
</span><span class='line'>\# See ~/.ssh/conf.d/README.md for instructions</span></code></pre></td></tr></table></div></figure>


<h5>global host configuration:</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>\##################################################################
</span><span class='line'>\# Global SSH Config - applied to all ssh commands
</span><span class='line'>Host *
</span><span class='line'>    ## SSH keepalive and timeout Options ##
</span><span class='line'>    ServerAliveInterval 60
</span><span class='line'>    ServerAliveCountMax 5
</span><span class='line'>    VisualHostKey yes
</span><span class='line'>
</span><span class='line'>    ## Channel Control Multiplexer Options ##
</span><span class='line'>    ControlMaster auto
</span><span class='line'>    ControlPath ~/.ssh/sockets/%r@%h:%p
</span><span class='line'>    ControlPersist 4h
</span><span class='line'>
</span><span class='line'>    ## Specify secure ciphers and MAC algorythms
</span><span class='line'>    KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256
</span><span class='line'>    HostKeyAlgorithms ssh-ed25519-cert-v01@openssh.com,ssh-rsa-cert-v01@openssh.com,ssh-rsa-cert-v00@openssh.com,ssh-ed25519,ssh-rsa
</span><span class='line'>    Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
</span><span class='line'>    MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-ripemd160-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,hmac-ripemd160,umac-128@openssh.com
</span><span class='line'>
</span><span class='line'>    ## Dont hash knownhosts, so zsh autocompletion can read them ##
</span><span class='line'>    HashKnownHosts no
</span><span class='line'>
</span><span class='line'>##################################################################</span></code></pre></td></tr></table></div></figure>


<p>I hope this post has been useful to someone and thought I&rsquo;d share my setup.</p>

<h3>In Summary</h3>

<p>Yes theres most likely a better implimentation and yes you might see it as rough, but its a good start and good foundation to work from to make it better.</p>

<p>I&rsquo;m still perfecting my ssh config setup and yet to run into any limitations or issues
(one issue im sure i&rsquo;ll encounter is rsync and scp as they wont update the config if they are called.
I guess as long as I call ssh after an update, all will be good.</p>

<p>I&rsquo;ll update here as I make better changes.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2015/03/10/test-your-physical-security/">Have you checked your security?</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2015-03-10T09:36:22+13:00" pubdate><i class="fa fa-calendar"></i> Mar 10th, 2015</time>




            

    <div class="article__tags pull-left">
        <i class="fa fa-tags"></i>
        <ul class="unstyled">
        
            
                <li><a class='category' href='/blog/categories/pentest/'>pentest</a></li>
            
                <li><a class='category' href='/blog/categories/security/'>security</a></li>
            
            
        </ul>
    </div>


            
        </div>
    
</header>




    <p>We all have a fancy expensive alarm system in our work places, some more fancy
then others; motion sensors, cameras, biometrics, door bolts.
But have you ever actually tested it?</p>

<p>No, I don&rsquo;t mean the odd &ldquo;I came into work on the weekend and set it off&rdquo; excuse
given by staff who say &ldquo;Well it definitely worked&rdquo;. I mean testing the physical
security of your system as a burglar hoping to steal your sensitive financial and
company documents.</p>

<p>It&rsquo;s not something we think of when it comes to security, sure we get our
networks, web applications and business processes audited and tested by
auditors and ethical penetration testing consultants, but the physical alarm system
is never &ldquo;physically&rdquo; tested - we get it installed and take the installers word
that, &ldquo;Your all protected now&rdquo;, and for some reason, that&rsquo;s enough to keep our
worries at bay. Imagine if your developers say, &ldquo;Oh yeah, our new Credit Card
database is all protected&rdquo; and you left it at that, our world would be a VERY
different place.</p>

<p>When it comes to testing your physical security, it&rsquo;s not recommended to just
&ldquo;go for it&rdquo; (Did someone say hack on prod?). You might find your staff, and
building neighbours may not appreciate it.
You need to create a test environment which is a copy of your real alarm, and
now, I don&rsquo;t mean go buy a whole new system just for testing, instead consult your alarm
security contractors about creating a test zone which acts like the main
system.</p>

<p>Next, identify potential targets such as financial documents, important servers
or anything business critical. These should be targets which would be of interest
to anyone breaking in, whether they have insider knowledge or not. These targets
should be what you concentrate on &ldquo;testing&rdquo; and in future require careful planning
and protecting.</p>

<p>Finally, inform your monitoring company, who wants Mr Plod showing up to your
building as you attempt to break in? At least you could always try the &ldquo;I
Locked my keys inside&rdquo; excuse and see how that fly&rsquo;s&hellip;</p>

<p>Now you have set yourself up, think up some creative ways to &ldquo;break in&rdquo;,
have a look around your offices; are the doors secure;
can you climb the walls; can you move undetected from motion sensors?
I Find Google has the best ideas and solutions to problems you might overcome
when trying to bypass a motion sensor.</p>

<p>A few simple words of advice:</p>

<ol>
<li><p>Be safe, you could find yourself dropping from
heights or doing something physically demanding, always have a look at whats
load bearing and stable.</p></li>
<li><p>Watch out for fire alarm cables. Sometimes you can&rsquo;t make a test environment
for everything. There&rsquo;s nothing worse than an expensive false callout fee (or
two) and even worse, setting the sprinklers off all over your perfectly
good not-on-fire office assets. - Your insurance company may not like you
very much.</p></li>
<li><p>Go slow and take your time. Your here to test, it&rsquo;s not a time trial. I&rsquo;ve
never heard of a criminal who stated his break-in was timed. You&rsquo;re in
control, take your time, look at everything, explore routes etc. If you set
off your test alarm. reset it and start again.</p></li>
<li><p>Don&rsquo;t break anything. This could be dangerous and costly to you and your
business, theres nothing worse than breaking your managers&#8217; new expensive oak
desk by stepping in the wrong place.</p></li>
</ol>


<p>You now have a repeatable test environment, which can be used to test your
physical security, over and over again. If you make changes or add new security
devices, simply update your test environment and have a go.</p>

<p>We recently underwent this process when a co-worker researching RFID swipe
cards managed to clone our access cards, rendering them unsecure, because of
this we started exploring what would happen if someone entered our building.
What can they do and, what could they take?</p>

<p>With that, we closed our office, set up a test alarm area, disabled the ear
piercing siren and told our monitoring company to ignore everything and played
a simple Capture the Flag game where we all took turns breaking in.</p>

<p>Unfortunately the results were not what we thought, it was somewhat easier then
we expected. We had people record pin numbers, climb walls, break tiles and
leave dirty shoe marks on our walls - All in an attempt to grab a nice cold
alcoholic beverage from our &ldquo;secure&rdquo; area.</p>

<p>This exercise was a wakeup call and allowed us to see what flaws we have,
instead of letting a security installer tell us it&rsquo;s all OK.</p>

<p>So, in conclusion, here are some helpful tips to avoid problems:</p>

<ul>
  <li>Always be safe!</li>
  <li>Create a dummy test zone which mirrors your usual alarm area/s.</li>
  <li>Look out of fire alarm cables, fire engine callouts are not cheap.</li>
  <li>Tell your monitoring company to ignore anything they receive.</li>
  <li>Create goals for your testers.</li>
  <li>Play it slow and safe, if something&#8217;s not right, stop and have a look.</li>
  <li>And finally&#8230; Have Fun!</li>
</ul>




        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2015/02/10/cloning-your-octopress-blog/">Cloning Your Octopress Blog</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2015-02-10T08:43:56+13:00" pubdate><i class="fa fa-calendar"></i> Feb 10th, 2015</time>




            

    <div class="article__tags pull-left">
        <i class="fa fa-tags"></i>
        <ul class="unstyled">
        
            
                <li><a class='category' href='/blog/categories/git/'>git</a></li>
            
                <li><a class='category' href='/blog/categories/octopress/'>octopress</a></li>
            
            
        </ul>
    </div>


            
        </div>
    
</header>




    <div class="article__content clearfix">
        <p>I&rsquo;ve spent hours and many &lsquo;dud&rsquo; commits to my github repository trying to figure
out too re-clone my octopress repository to either my current development
computer, or too another one. I have found one working solution.</p>


        <a class="btn pull-right" href="/blog/2015/02/10/cloning-your-octopress-blog/">Read on &rarr;</a>
    </div>


        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2015/02/04/zaw-plugin/">Zaw Plugin</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2015-02-04T12:44:15+13:00" pubdate><i class="fa fa-calendar"></i> Feb 4th, 2015</time>




            

    <div class="article__tags pull-left">
        <i class="fa fa-tags"></i>
        <ul class="unstyled">
        
            
                <li><a class='category' href='/blog/categories/zsh/'>zsh</a></li>
            
            
        </ul>
    </div>


            
        </div>
    
</header>




    <div class="article__content clearfix">
        <h3>What is zaw</h3>

<p>Zaw is zsh plugin which acts like a widget to bring together a wealth of resources
making it easier to find what you need in you shell.</p>


        <a class="btn pull-right" href="/blog/2015/02/04/zaw-plugin/">Read on &rarr;</a>
    </div>


        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2015/02/04/notes-on-octopress/">Notes on Octopress</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2015-02-04T11:10:31+13:00" pubdate><i class="fa fa-calendar"></i> Feb 4th, 2015</time>




            

    <div class="article__tags pull-left">
        <i class="fa fa-tags"></i>
        <ul class="unstyled">
        
            
                <li><a class='category' href='/blog/categories/octopress/'>octopress</a></li>
            
            
        </ul>
    </div>


            
        </div>
    
</header>




    <div class="article__content clearfix">
        <p>Here are a few notes and code snippets I use to manage octopress, They arnt
exactly new, just needed a place to put them incase I forget.</p>


        <a class="btn pull-right" href="/blog/2015/02/04/notes-on-octopress/">Read on &rarr;</a>
    </div>


        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2015/02/04/my-first-post/">My First Post</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2015-02-04T08:49:04+13:00" pubdate><i class="fa fa-calendar"></i> Feb 4th, 2015</time>




            

    <div class="article__tags pull-left">
        <i class="fa fa-tags"></i>
        <ul class="unstyled">
        
            
                <li><a class='category' href='/blog/categories/octopress/'>octopress</a></li>
            
            
        </ul>
    </div>


            
        </div>
    
</header>




    <p>This is my first blog post. Hopefully It wont be my last.</p>

<p>I will hopefully use this blog to post useful information and stuff which i dont want to forget</p>



        </article>
        <hr>
    

    <div class="pagination">
    

    
    </div>

                </div>

                
                <aside class="sidebar col-xs-12 col-md-4 col-lg-4">
                    <div class="row">

    

    
<section class="social col-xs-12 col-sm-6 col-md-12">
    <h1>
        My Social Networks
    </h1>
    <ul class="unstyled">
        
        <li><a class="coinbase" href="//coinbase.com/danielgadd"><i class="fa fa-btc"></i> Coinbase</a></li>
        
        
        <li><a class="github" href="//github.com/daniel-gadd"><i class="fa fa-github"></i> Github</a></li>
        
        
        
        <li><a class="linkedin" href="//linkedin.com/in/danielgadd"><i class="fa fa-linkedin-square"></i> LinkedIn</a></li>
        
        
        
        <li><a class="twitter" href="//twitter.com/dangad999"><i class="fa fa-twitter"></i> Twitter</a></li>
        
    </ul>
</section>



    <section id="recent-posts" class="col-xs-12 col-sm-6 col-md-12">
    <h1>Recent Posts</h1>
    <ul class="divided">
        
        <li class="post">
            <a href="/blog/2015/05/05/better-management-of-ssh-config-files/">Better management of ssh config files</a>
        </li>
        
        <li class="post">
            <a href="/blog/2015/03/10/test-your-physical-security/">Have you checked your security?</a>
        </li>
        
        <li class="post">
            <a href="/blog/2015/02/10/cloning-your-octopress-blog/">Cloning Your Octopress Blog</a>
        </li>
        
        <li class="post">
            <a href="/blog/2015/02/04/zaw-plugin/">Zaw Plugin</a>
        </li>
        
        <li class="post">
            <a href="/blog/2015/02/04/notes-on-octopress/">Notes on Octopress</a>
        </li>
        
    </ul>
</section>

<section id="github-repos" class="col-xs-12 col-sm-6 col-md-12">
    <h1>
        GitHub Repos
        
        <small class="pull-right">
            <a class="btn" href="//github.com/daniel-gadd" title="@daniel-gadd on GitHub" target="_blank">
                <i class="fa fa-external-link"></i>
            </a>
        </small>
        
    </h1>
    <ul id="gh_repos" class="divided">
        <li class="loading">
            <i class="fa fa-spinner fa-spin"></i>
        </li>
    </ul>
</section>






</div>

                </aside>
                
            </div>
        </div>

        

    
    




<footer class="footer">
    <div class="row middle-xs">
        
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <p class="footer__copyright">
    All content copyright Daniel Gadd.<br>
    Powered By <a href="//octopress.org">Octopress</a>.
</p>

        </div>
        
        
    </div>
</footer>


        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
<script defer src="/javascripts/octopress.js"></script>


<script>
    var _gaq=[['_setAccount','UA-59342030-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
</script>



<script>
    var disqus_shortname = 'danielgadd';
    
        
        var disqus_script = 'count.js';
    
    (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





<script>
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'daniel-gadd',
            count: 0,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
</script>
<script src="/javascripts/github.js"></script>







    </body>

</html>
